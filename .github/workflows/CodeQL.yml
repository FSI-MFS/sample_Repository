# ほとんどのプロジェクトでは、このワークフローファイルを変更する必要はありません。
# リポジトリにこのファイルをコミットするだけで使用できます。
#
# 解析対象の言語を変更したり、独自のクエリやビルド処理を追加したい場合は、
# このファイルを編集してください。
#
# ******** 注意 ********
# リポジトリ内の言語を自動検出しています。
# 下の `language` マトリクスを確認して、CodeQLがサポートする言語が正しく設定されているか確認してください。
name: "CodeQL"

on:
  workflow_dispatch:
  push:
    branches: [main]
  pull_request:
    # 下記のブランチは上記のブランチのサブセットである必要があります
    branches: [main]

jobs:
  analyze:
    name: Analyze
    runs-on: ubuntu-latest

    permissions:
      actions: read
      contents: read
      security-events: write  # CodeQLの結果をセキュリティイベントとしてアップロードするために必要

    strategy:
      fail-fast: false
      matrix:
        language: ['cpp', 'csharp', 'go', 'java', 'javascript', 'python', 'ruby']
        # CodeQLがサポートする言語一覧：
        # ['cpp', 'csharp', 'go', 'java', 'javascript', 'python', 'ruby']
        # 詳細：https://git.io/codeql-language-support

    steps:
      - name: リポジトリのチェックアウト
        uses: actions/checkout@v2

      # CodeQLツールを初期化してスキャンの準備をします
      - name: CodeQLの初期化
        uses: github/codeql-action/init@v1
        with:
          languages: ${{ matrix.language }}
          # 独自のクエリを指定したい場合は、ここか設定ファイルで指定できます。
          # デフォルトでは、ここに記載したクエリが設定ファイルの内容を上書きします。
          # `+` を先頭につけると、ここで指定したクエリと設定ファイルの両方を使用できます。
          # queries: +./path/to/local/query, your-org/your-repo/queries@main

      # Autobuildは、C/C++、C#、Javaなどのコンパイル言語を自動的にビルドしようとします。
      # このステップが失敗した場合は、削除して手動でビルドを行ってください（下記参照）
      - name: Autobuild（自動ビルド）
        uses: github/codeql-action/autobuild@v1

      # ℹ️ OSのシェルで実行するコマンドラインプログラムです。
      # 📚 詳細：https://git.io/JvXDl
      # ✏️ Autobuildが失敗した場合は、上記ステップを削除し、以下の3行をコメント解除して、
      # 必要に応じて修正・追加してください
      #- run: |
      #    make bootstrap
      #    make release

      # CodeQL解析を実行し、結果をSARIF形式でアップロードします
      - name: CodeQL解析の実行
        uses: github/codeql-action/analyze@v1


